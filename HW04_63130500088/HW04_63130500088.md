# R-Assignment 4

**Created by Panupong Nakmanee (ID: 63130500088)**

Choose Dataset: Superstore Sales Dataset (Data from Rohit Sahoo,[Kaggle](https://www.kaggle.com/rohitsahoo/sales-forecasting)) >> [Using CSV](https://raw.githubusercontent.com/safesit23/INT214-Statistics/main/datasets/superstore_sales.csv)


### Outlines
1. Explore the dataset
2. Learning function from Tidyverse
3. Transform data with dplyr and finding insight the data
4. Visualization with GGplot2

## Part 1: Explore the dataset

### Loading library and dataset
```
# Library
install.packages("tidyverse")
library(tidyverse)

# Dataset
superstore <- read.csv("https://raw.githubusercontent.com/safesit23/INT214-Statistics/main/datasets/superstore_sales.csv")
```

Retail dataset of a global superstore for 4 years.
### Explore the dataset
```
View(superstore)
glimpse(superstore)
```
In this dataset has 9,800 rows and 18 columns to store data about retail dataset of a global superstore for 4 years that contain
```
> glimpse(superstore)
Rows: 9,800
Columns: 18
$ Row.ID        <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1~
$ Order.ID      <chr> "CA-2017-152156", "CA-2017-152156", "CA-2017-138688", "US-20~
$ Order.Date    <chr> "08/11/2017", "08/11/2017", "12/06/2017", "11/10/2016", "11/~
$ Ship.Date     <chr> "11/11/2017", "11/11/2017", "16/06/2017", "18/10/2016", "18/~
$ Ship.Mode     <chr> "Second Class", "Second Class", "Second Class", "Standard Cl~
$ Customer.ID   <chr> "CG-12520", "CG-12520", "DV-13045", "SO-20335", "SO-20335", ~
$ Customer.Name <chr> "Claire Gute", "Claire Gute", "Darrin Van Huff", "Sean O'Don~
$ Segment       <chr> "Consumer", "Consumer", "Corporate", "Consumer", "Consumer",~
$ Country       <chr> "United States", "United States", "United States", "United S~
$ City          <chr> "Henderson", "Henderson", "Los Angeles", "Fort Lauderdale", ~
$ State         <chr> "Kentucky", "Kentucky", "California", "Florida", "Florida", ~
$ Postal.Code   <int> 42420, 42420, 90036, 33311, 33311, 90032, 90032, 90032, 9003~
$ Region        <chr> "South", "South", "West", "South", "South", "West", "West", ~
$ Product.ID    <chr> "FUR-BO-10001798", "FUR-CH-10000454", "OFF-LA-10000240", "FU~
$ Category      <chr> "Furniture", "Furniture", "Office Supplies", "Furniture", "O~
$ Sub.Category  <chr> "Bookcases", "Chairs", "Labels", "Tables", "Storage", "Furni~
$ Product.Name  <chr> "Bush Somerset Collection Bookcase", "Hon Deluxe Fabric Upho~
$ Sales         <dbl> 261.9600, 731.9400, 14.6200, 957.5775, 22.3680, 48.8600, 7.2~
```

## Part 2: Learning function from Tidyverse

- Function `dmy()` from package [lubridate](https://lubridate.tidyverse.org/reference/ymd.html). It using for parse dates with year, month, and day components.
- Function `year()` from package [lubridate](https://lubridate.tidyverse.org/reference/year.html). It using for get/set years component of a date-time.

```
superstore  %>% mutate(year = year(dmy(Order.Date))) %>% group_by(year) %>% summarise(mean = mean(Sales))
```

## Part 3: Transform data with dplyr and finding insight the data

### 1. In which category do people buy the most?
ใช้คำสั่ง `select()` เพื่อเลือกดู category และ sales และ ใช้คำสั่ง `group_by()` ด้วย category ใช้คำสั่ง `summarise()` เพื่อสรุปผล sales ของแต่ละ category จากนั้นใช้คำสั่ง `filter()` ด้วยค่าของ Sales ที่มีค่ามากที่สุดในรายการ
```
superstore %>% select(Category,Sales) %>% group_by(Category) %>% summarise(Sales = sum(Sales)) %>% filter(Sales == max(Sales))
```

Result:

```
# A tibble: 1 x 2
  Category     Sales
  <chr>        <dbl>
1 Technology 827456.
```
Summary:
```
Technology is the most sold in the category table.
```
### 2. What is the total sales in each city? And which city has the most sales?
ใช้คำสั่ง `select()` เพื่อเลือกข้อมูล city state sales จากนั้น `groub_by()` city,state `summarise()`เพื่อหาค่ารวมของ sales , ในการสรุปหาผลรวมของยอด Sale ในแต่ละรัฐ จากนั้นนำไปเก็บไว้ใน state เพื่อนำไปหาว่ารัฐไหนมียอดขายน้อยที่สุดโดยใช้คำสั่ง `filter()` ในการ filter Sales และใช้ `min()` ในการหาค่าน้อยที่สุดของ sales 
```
superstore %>% select(City,State,Sales) %>% group_by(City,State) %>% summarise(Sales = sum(Sales)) %>% print(n = 1000)

state <- superstore %>% group_by(State) %>% summarise(Sales = sum(Sales)) 
state %>% filter(Sales == min(Sales))
```

Result:

```
# A tibble: 600 x 3
# Groups:   City [529]
    City              State                    Sales
    <chr>             <chr>                    <dbl>
  1 Aberdeen          South Dakota             25.5 
  2 Abilene           Texas                     1.39
  3 Akron             Ohio                   2724.  
  4 Albuquerque       New Mexico             2220.  
  5 Alexandria        Virginia               5520.  
  6 Allen             Texas                   290.  
  7 Allentown         Pennsylvania            853.  
  8 Altoona           Pennsylvania             20.5 
  9 Amarillo          Texas                  3773.  
 10 Anaheim           California             5601.  
 11 Andover           Massachusetts           436.  
 12 Ann Arbor         Michigan                889.  
 13 Antioch           California               19.4 
 14 Apopka            Florida                 905.  
 15 Apple Valley      California             1915.  
 16 Apple Valley      Minnesota               138.  
 17 Appleton          Wisconsin              1671.  
 18 Arlington         Texas                  5848.  
 19 Arlington         Virginia              14367.  
 20 Arlington Heights Illinois                 14.1 
 21 Arvada            Colorado                503.  
 22 Asheville         North Carolina         1475.  
 23 Athens            Georgia                1435.  
 24 Atlanta           Georgia               17198.  
 25 Atlantic City     New Jersey               23.4 
 26 Auburn            Alabama                1767.  
 27 Auburn            New York               1384.  
 28 Auburn            Washington                4.18
 29 Aurora            Colorado               4084.  
 30 Aurora            Illinois               7573.  
 31 Austin            Texas                  6058.  
 32 Avondale          Arizona                 947.  
 33 Bakersfield       California             1377.  
 34 Baltimore         Maryland               6157.  
 35 Bangor            Maine                  1164.  
 36 Bartlett          Tennessee                89.0 
 37 Bayonne           New Jersey              183.  
 38 Baytown           Texas                    10.4 
 39 Beaumont          Texas                   144.  
 40 Bedford           Texas                   226.  
 41 Belleville        New Jersey             1892.  
 42 Bellevue          Washington              104.  
 43 Bellingham        Washington             3790.  
 44 Bethlehem         Pennsylvania           1690.  
 45 Beverly           Massachusetts          2583.  
 46 Billings          Montana                   8.29
 47 Bloomington       Illinois                964.  
 48 Bloomington       Indiana                 604.  
 49 Boca Raton        Florida                  63.0 
 50 Boise             Idaho                  1094.  
 51 Bolingbrook       Illinois                218.  
 52 Bossier City      Louisiana              1417.  
 53 Bowling Green     Kentucky                212.  
 54 Bowling Green     Ohio                   1866.  
 55 Boynton Beach     Florida                 470.  
 56 Bozeman           Montana                  43.7 
 57 Brentwood         California             5090.  
 58 Bridgeton         New Jersey               52.4 
 59 Bristol           Connecticut             815.  
 60 Bristol           Tennessee               437.  
 61 Broken Arrow      Oklahoma               2440.  
 62 Broomfield        Colorado                794.  
 63 Brownsville       Texas                  1292.  
 64 Bryan             Texas                    65.8 
 65 Buffalo           New York               9063.  
 66 Buffalo Grove     Illinois                831.  
 67 Bullhead City     Arizona                  22.3 
 68 Burbank           California             3247.  
 69 Burlington        Iowa                     57.4 
 70 Burlington        North Carolina        12681.  
 71 Burlington        Vermont                8929.  
 72 Caldwell          Idaho                   456.  
 73 Camarillo         California             1468.  
 74 Cambridge         Massachusetts           502.  
 75 Canton            Michigan                818.  
 76 Carlsbad          New Mexico              419.  
 77 Carol Stream      Illinois               1306.  
 78 Carrollton        Texas                  2048.  
 79 Cary              North Carolina          505.  
 80 Cedar Hill        Texas                   122.  
 81 Cedar Rapids      Iowa                    278.  
 82 Champaign         Illinois                152.  
 83 Chandler          Arizona                1067.  
 84 Chapel Hill       North Carolina           14.0 
 85 Charlotte         North Carolina        13451.  
 86 Charlottesville   Virginia                103.  
 87 Chattanooga       Tennessee               989.  
 88 Chesapeake        Virginia               5997.  
 89 Chester           Pennsylvania           1968.  
 90 Cheyenne          Wyoming                1603.  
 91 Chicago           Illinois              47820.  
 92 Chico             California             2050.  
 93 Chula Vista       California             1042.  
 94 Cincinnati        Ohio                   1612.  
 95 Citrus Heights    California              129.  
 96 Clarksville       Tennessee              2218.  
 97 Cleveland         Ohio                   5282.  
 98 Clifton           New Jersey              337.  
 99 Clinton           Maryland               5514.  
100 Clovis            New Mexico              111.  
101 Coachella         California              164.  
102 College Station   Texas                   291.  
103 Colorado Springs  Colorado               3694.  
104 Columbia          Maryland              10962.  
105 Columbia          Missouri               2990.  
106 Columbia          South Carolina         6168.  
107 Columbia          Tennessee              5163.  
108 Columbus          Georgia               14801.  
109 Columbus          Indiana                7960.  
110 Columbus          Ohio                  15901.  
111 Commerce City     Colorado                146.  
112 Concord           California             2603.  
113 Concord           New Hampshire          2828.  
114 Concord           North Carolina         5112.  
115 Conroe            Texas                   112.  
116 Conway            Arkansas                302.  
117 Coon Rapids       Minnesota               503.  
118 Coppell           Texas                   136.  
119 Coral Gables      Florida                  64.2 
120 Coral Springs     Florida                 825.  
121 Corpus Christi    Texas                   221.  
122 Costa Mesa        California             1118.  
123 Cottage Grove     Minnesota               144.  
124 Covington         Washington              414.  
125 Cranston          Rhode Island           3922.  
126 Cuyahoga Falls    Ohio                     29.1 
127 Dallas            Texas                 20128.  
128 Danbury           Connecticut              27.5 
129 Danville          California             1159.  
130 Danville          Illinois                 43.4 
131 Davis             California               32.4 
132 Daytona Beach     Florida                 272.  
133 Dearborn          Michigan               1603.  
134 Dearborn Heights  Michigan               1052.  
135 Decatur           Alabama                3375.  
136 Decatur           Illinois               2959.  
137 Deer Park         Texas                     6.92
138 Delray Beach      Florida                 243.  
139 Deltona           Florida                 893.  
140 Denver            Colorado              12199.  
141 Des Moines        Iowa                   2009.  
142 Des Moines        Washington             3454.  
143 Des Plaines       Illinois               1493.  
144 Detroit           Michigan              42447.  
145 Dover             Delaware                449.  
146 Dover             New Hampshire          4429.  
147 Draper            Utah                    264.  
148 Dublin            California               22   
149 Dublin            Ohio                   2379.  
150 Dubuque           Iowa                   1687.  
151 Durham            North Carolina          880.  
152 Eagan             Minnesota               214.  
153 East Orange       New Jersey               31.8 
154 East Point        Georgia                 268.  
155 Eau Claire        Wisconsin              1646.  
156 Edinburg          Texas                    88.3 
157 Edmond            Oklahoma                960.  
158 Edmonds           Washington             2524.  
159 El Cajon          California              866.  
160 El Paso           Texas                  3546.  
161 Elkhart           Indiana                 171.  
162 Elmhurst          Illinois                892.  
163 Elyria            Ohio                      1.82
164 Encinitas         California              592.  
165 Englewood         Colorado                124.  
166 Escondido         California               94.5 
167 Eugene            Oregon                 1465.  
168 Evanston          Illinois               1754.  
169 Everett           Massachusetts          5662.  
170 Everett           Washington                3.86
171 Fairfield         California             1471.  
172 Fairfield         Connecticut            4936.  
173 Fairfield         Ohio                   2512.  
174 Fargo             North Dakota            920.  
175 Farmington        New Mexico              719.  
176 Fayetteville      Arkansas               3743.  
177 Fayetteville      North Carolina         3183.  
178 Florence          Alabama                1997.  
179 Florence          Kentucky               4542.  
180 Florence          South Carolina         1065.  
181 Fort Collins      Colorado                935.  
182 Fort Lauderdale   Florida                4855.  
183 Fort Worth        Texas                  6603.  
184 Frankfort         Illinois                 97.6 
185 Franklin          Massachusetts          5535.  
186 Franklin          Tennessee               948.  
187 Franklin          Wisconsin              4774.  
188 Freeport          Illinois                216.  
189 Freeport          New York                523.  
190 Fremont           Nebraska               1119.  
191 Fresno            California             7889.  
192 Frisco            Texas                    57.5 
193 Gaithersburg      Maryland                406.  
194 Garden City       Kansas                  312.  
195 Garland           Texas                    67.7 
196 Gastonia          North Carolina          895.  
197 Georgetown        Kentucky               1786.  
198 Gilbert           Arizona                4172.  
199 Gladstone         Missouri                164.  
200 Glendale          Arizona                2918.  
201 Glenview          Illinois                158.  
202 Goldsboro         North Carolina           34.9 
203 Grand Island      Nebraska                 16.0 
204 Grand Prairie     Texas                  1012.  
205 Grand Rapids      Michigan                393.  
206 Grapevine         Texas                    41.5 
207 Great Falls       Montana                4606.  
208 Greeley           Colorado                 30.4 
209 Green Bay         Wisconsin               527.  
210 Greensboro        North Carolina         2407.  
211 Greenville        North Carolina         2118.  
212 Greenwood         Indiana                1665.  
213 Gresham           Oregon                 2133.  
214 Grove City        Ohio                    124.  
215 Gulfport          Mississippi             166.  
216 Hackensack        New Jersey             1456.  
217 Hagerstown        Maryland                 43.8 
218 Haltom City       Texas                   269.  
219 Hamilton          Ohio                    328.  
220 Hampton           Virginia               2722.  
221 Harlingen         Texas                   471.  
222 Harrisonburg      Virginia               4389.  
223 Hattiesburg       Mississippi            1723.  
224 Helena            Montana                 444.  
225 Hempstead         New York               2590.  
226 Henderson         Kentucky              15661.  
227 Henderson         Nevada                 1888.  
228 Hendersonville    Tennessee               320.  
229 Hesperia          California             1213.  
230 Hialeah           Florida                2339.  
231 Hickory           North Carolina           40.8 
232 Highland Park     Illinois               2035.  
233 Hillsboro         Oregon                   87.8 
234 Holland           Michigan                138.  
235 Hollywood         Florida                1070.  
236 Holyoke           Massachusetts           302.  
237 Homestead         Florida                 133.  
238 Hoover            Alabama                 526.  
239 Hot Springs       Arkansas                246.  
240 Houston           Texas                 63956.  
241 Huntington Beach  California             2528.  
242 Huntsville        Alabama                2484.  
243 Huntsville        Texas                  6711.  
244 Independence      Missouri               2417.  
245 Indianapolis      Indiana                4834.  
246 Inglewood         California             3479.  
247 Iowa City         Iowa                      9.99
248 Irving            Texas                   606.  
249 Jackson           Michigan              15420.  
250 Jackson           Mississippi            7427.  
251 Jackson           Tennessee              2117.  
252 Jacksonville      Florida               39133.  
253 Jacksonville      North Carolina         5580.  
254 Jamestown         New York               4709.  
255 Jefferson City    Missouri                 86.6 
256 Johnson City      Tennessee               766.  
257 Jonesboro         Arkansas               2915.  
258 Jupiter           Florida                   2.06
259 Keller            Texas                     6   
260 Kenner            Louisiana                89.3 
261 Kenosha           Wisconsin              3907.  
262 Kent              Ohio                    346.  
263 Kent              Washington             1351.  
264 Kirkwood          Missouri                241.  
265 Kissimmee         Florida                 752.  
266 Knoxville         Tennessee              3928.  
267 La Crosse         Wisconsin               830.  
268 La Mesa           California              368.  
269 La Porte          Indiana                1021.  
270 La Quinta         California               46.3 
271 Lafayette         Indiana               19625.  
272 Lafayette         Louisiana              5320.  
273 Laguna Niguel     California              291.  
274 Lake Charles      Louisiana               547.  
275 Lake Elsinore     California              284.  
276 Lake Forest       California             1626.  
277 Lakeland          Florida                5607.  
278 Lakeville         Minnesota              4261.  
279 Lakewood          California             1584.  
280 Lakewood          New Jersey            14843.  
281 Lakewood          Ohio                   1756.  
282 Lancaster         California              477.  
283 Lancaster         Ohio                   8203.  
284 Lancaster         Pennsylvania           1211.  
285 Lansing           Michigan               1610.  
286 Laredo            Texas                  1024.  
287 Las Cruces        New Mexico               98.8 
288 Las Vegas         Nevada                 1834.  
289 Laurel            Maryland                153.  
290 Lawrence          Indiana                1545.  
291 Lawrence          Massachusetts          6109.  
292 Lawton            Oklahoma               1057.  
293 Layton            Utah                      4.96
294 League City       Texas                   875.  
295 Lebanon           Tennessee               489.  
296 Lehi              Utah                   1517.  
297 Leominster        Massachusetts           217.  
298 Lewiston          Idaho                     9.58
299 Lewiston          Maine                   106.  
300 Lincoln Park      Michigan                388.  
301 Linden            New Jersey              115.  
302 Lindenhurst       New York                 55.5 
303 Little Rock       Arkansas               3560.  
304 Littleton         Colorado                 72.3 
305 Logan             Utah                    280.  
306 Long Beach        California             3875.  
307 Long Beach        New York               8434.  
308 Longmont          Colorado                915.  
309 Longview          Washington              119.  
310 Lorain            Ohio                   2015.  
311 Los Angeles       California           173420.  
312 Louisville        Colorado               4804.  
313 Louisville        Kentucky               7275.  
314 Loveland          Colorado                 21.0 
315 Lowell            Massachusetts          4838.  
316 Lubbock           Texas                   593.  
317 Macon             Georgia                 364.  
318 Madison           Wisconsin              5347.  
319 Malden            Massachusetts           228.  
320 Manchester        Connecticut            2126.  
321 Manhattan         Kansas                  274.  
322 Mansfield         Texas                   559.  
323 Manteca           California              452.  
324 Maple Grove       Minnesota               883.  
325 Margate           Florida                  15.6 
326 Marietta          Georgia                2939.  
327 Marion            Iowa                    222.  
328 Marion            Ohio                   3011.  
329 Marlborough       Massachusetts           207.  
330 Marysville        Washington              102.  
331 Mcallen           Texas                   867.  
332 Medford           Oregon                   90.2 
333 Medina            Ohio                   2478.  
334 Melbourne         Florida                  95.6 
335 Memphis           Tennessee              5942.  
336 Mentor            Ohio                    693.  
337 Meriden           Connecticut            1551.  
338 Meridian          Idaho                   329.  
339 Mesa              Arizona                4038.  
340 Mesquite          Texas                    52.1 
341 Miami             Florida                8648.  
342 Middletown        Connecticut            1155.  
343 Midland           Michigan               5292.  
344 Milford           Connecticut             962.  
345 Milwaukee         Wisconsin             10469.  
346 Minneapolis       Minnesota             16871.  
347 Miramar           Florida                1531.  
348 Mishawaka         Indiana                 776.  
349 Mission Viejo     California              776.  
350 Missoula          Montana                 488.  
351 Missouri City     Texas                     6.37
352 Mobile            Alabama                5463.  
353 Modesto           California              326.  
354 Monroe            Louisiana              1757.  
355 Monroe            North Carolina         1213.  
356 Montebello        California               27.9 
357 Montgomery        Alabama                3723.  
358 Moorhead          Minnesota               544.  
359 Moreno Valley     California             1262.  
360 Morgan Hill       California              545.  
361 Morristown        New Jersey             5033.  
362 Mount Pleasant    Michigan                 17.1 
363 Mount Pleasant    South Carolina          546.  
364 Mount Vernon      New York               2120.  
365 Murfreesboro      Tennessee               337.  
366 Murray            Kentucky                265.  
367 Murray            Utah                    146.  
368 Murrieta          California              485.  
369 Muskogee          Oklahoma               1722.  
370 Naperville        Illinois               1288.  
371 Nashua            New Hampshire            35.9 
372 Nashville         Tennessee              6071.  
373 New Albany        Indiana                 210.  
374 New Bedford       Massachusetts           236.  
375 New Brunswick     New Jersey               14.8 
376 New Castle        Indiana                  84.6 
377 New Rochelle      New York                978.  
378 New York City     New York             252463.  
379 Newark            Delaware              20320.  
380 Newark            Ohio                   8128.  
381 Newport News      Virginia               3322.  
382 Niagara Falls     New York                 35.0 
383 Noblesville       Indiana                3091.  
384 Norfolk           Nebraska                 17.4 
385 Normal            Illinois                367.  
386 Norman            Oklahoma               1351.  
387 North Charleston  South Carolina          284.  
388 North Las Vegas   Nevada                 9801.  
389 North Miami       Florida                  22.1 
390 Norwich           Connecticut             414.  
391 Oak Park          Illinois                 10.2 
392 Oak Park          Michigan                581.  
393 Oakland           California             5964.  
394 Oceanside         California              500.  
395 Oceanside         New York               3851.  
396 Odessa            Texas                   976.  
397 Oklahoma City     Oklahoma               6597.  
398 Olathe            Kansas                  896.  
399 Olympia           Washington             1020.  
400 Omaha             Nebraska               6313.  
401 Ontario           California              284.  
402 Orange            New Jersey              211.  
403 Orem              Utah                   2994.  
404 Orland Park       Illinois                340.  
405 Orlando           Florida                1740.  
406 Ormond Beach      Florida                   2.81
407 Oswego            Illinois                322.  
408 Overland Park     Kansas                  607.  
409 Owensboro         Kentucky                 71.2 
410 Oxnard            California             1558.  
411 Palatine          Illinois                116.  
412 Palm Coast        Florida                 274.  
413 Park Ridge        Illinois                685   
414 Parker            Colorado               1068.  
415 Parma             Ohio                   3816.  
416 Pasadena          California             4113.  
417 Pasadena          Texas                  2477.  
418 Pasco             Washington             2201.  
419 Passaic           New Jersey             1562.  
420 Paterson          New Jersey             2243.  
421 Pearland          Texas                   495.  
422 Pembroke Pines    Florida                1714.  
423 Pensacola         Florida                   2.21
424 Peoria            Arizona                1341.  
425 Peoria            Illinois                501.  
426 Perth Amboy       New Jersey             1717.  
427 Pharr             Texas                  1541.  
428 Philadelphia      Pennsylvania         108842.  
429 Phoenix           Arizona               11000.  
430 Pico Rivera       California              146.  
431 Pine Bluff        Arkansas                213.  
432 Plainfield        New Jersey             3728.  
433 Plano             Texas                  3530.  
434 Plantation        Florida                1437.  
435 Pleasant Grove    Utah                   2138.  
436 Pocatello         Idaho                  1345.  
437 Pomona            California             1483.  
438 Pompano Beach     Florida                  90.4 
439 Port Arthur       Texas                   737.  
440 Port Orange       Florida                   7.82
441 Port Saint Lucie  Florida                 249.  
442 Portage           Indiana                  16.3 
443 Portland          Oregon                 3905.  
444 Providence        Rhode Island          15981.  
445 Provo             Utah                   2761.  
446 Pueblo            Colorado               1687.  
447 Quincy            Illinois                330.  
448 Quincy            Massachusetts           946.  
449 Raleigh           North Carolina         4313.  
450 Rancho Cucamonga  California              232.  
451 Rapid City        South Dakota            153.  
452 Reading           Pennsylvania            874.  
453 Redding           California              334.  
454 Redlands          California             2891.  
455 Redmond           Oregon                 1043.  
456 Redmond           Washington               55.2 
457 Redondo Beach     California             1960.  
458 Redwood City      California               41.9 
459 Reno              Nevada                  644.  
460 Renton            Washington             1243.  
461 Revere            Massachusetts           833.  
462 Richardson        Texas                  1288.  
463 Richmond          Indiana                5876.  
464 Richmond          Kentucky               6646.  
465 Richmond          Virginia               5141.  
466 Rio Rancho        New Mexico             1114.  
467 Riverside         California             1944.  
468 Rochester         Minnesota              1957.  
469 Rochester         New York               6017.  
470 Rochester Hills   Michigan                133.  
471 Rock Hill         South Carolina           11.8 
472 Rockford          Illinois               3166.  
473 Rockville         Maryland                470.  
474 Rogers            Arkansas                 40.4 
475 Rome              New York                535.  
476 Romeoville        Illinois                  8.95
477 Roseville         California              735.  
478 Roseville         Michigan                638.  
479 Roseville         Minnesota              2216.  
480 Roswell           Georgia                6652.  
481 Round Rock        Texas                  4854.  
482 Royal Oak         Michigan                 35.3 
483 Sacramento        California             7311.  
484 Saginaw           Michigan                396.  
485 Saint Charles     Illinois               1389.  
486 Saint Charles     Missouri                271.  
487 Saint Cloud       Minnesota              1332.  
488 Saint Louis       Missouri                286.  
489 Saint Paul        Minnesota               193.  
490 Saint Peters      Missouri                697.  
491 Saint Petersburg  Florida                 753.  
492 Salem             Oregon                 1405.  
493 Salem             Virginia               2040.  
494 Salinas           California              729.  
495 Salt Lake City    Utah                    803.  
496 San Angelo        Texas                   651.  
497 San Antonio       Texas                 21844.  
498 San Bernardino    California              256.  
499 San Clemente      California               90.1 
500 San Diego         California            47521.  
501 San Francisco     California           109041.  
502 San Gabriel       California             2061.  
503 San Jose          California             6071.  
504 San Luis Obispo   California                3.62
505 San Marcos        Texas                   108.  
506 San Mateo         California               75.2 
507 Sandy Springs     Georgia                1997.  
508 Sanford           Florida                 226.  
509 Santa Ana         California             3366.  
510 Santa Barbara     California             3896.  
511 Santa Clara       California              222.  
512 Santa Fe          New Mexico              101.  
513 Santa Maria       California              115.  
514 Scottsdale        Arizona                1466.  
515 Seattle           Washington           116106.  
516 Sheboygan         Wisconsin                79.7 
517 Shelton           Connecticut              73.3 
518 Sierra Vista      Arizona                  76.1 
519 Sioux Falls       South Dakota           1137.  
520 Skokie            Illinois                569.  
521 Smyrna            Georgia                2130   
522 Smyrna            Tennessee               849.  
523 South Bend        Indiana                1238.  
524 Southaven         Mississippi            1455.  
525 Sparks            Nevada                 2562.  
526 Spokane           Washington             2028.  
527 Springdale        Arkansas                  4.3 
528 Springfield       Missouri              15051.  
529 Springfield       Ohio                   4387.  
530 Springfield       Oregon                 5761.  
531 Springfield       Virginia              16629.  
532 Sterling Heights  Michigan                110.  
533 Stockton          California             1228.  
534 Suffolk           Virginia               1598.  
535 Summerville       South Carolina          407.  
536 Sunnyvale         California              636.  
537 Superior          Wisconsin              1300.  
538 Tallahassee       Florida                7251.  
539 Tamarac           Florida                1414.  
540 Tampa             Florida                5196.  
541 Taylor            Michigan                354.  
542 Temecula          California              809.  
543 Tempe             Arizona                1070.  
544 Texarkana         Arkansas                654.  
545 Texas City        Texas                   791.  
546 The Colony        Texas                   142.  
547 Thomasville       North Carolina          151.  
548 Thornton          Colorado                765.  
549 Thousand Oaks     California              239.  
550 Tigard            Oregon                 1394.  
551 Tinley Park       Illinois                 22.3 
552 Toledo            Ohio                   4359.  
553 Torrance          California             3132.  
554 Trenton           Michigan               1765.  
555 Troy              New York               1327.  
556 Troy              Ohio                   3181.  
557 Tucson            Arizona                6313.  
558 Tulsa             Oklahoma               5557.  
559 Tuscaloosa        Alabama                 176.  
560 Twin Falls        Idaho                  1149.  
561 Tyler             Texas                   347.  
562 Urbandale         Iowa                    149.  
563 Utica             New York                575.  
564 Vacaville         California              423.  
565 Vallejo           California             1221.  
566 Vancouver         Washington              687.  
567 Vineland          New Jersey              648.  
568 Virginia Beach    Virginia               5752.  
569 Visalia           California              319.  
570 Waco              Texas                   606.  
571 Warner Robins     Georgia                 435.  
572 Warwick           Rhode Island           2427.  
573 Washington        District of Columbia   2865.  
574 Waterbury         Connecticut            1326.  
575 Waterloo          Iowa                     30.3 
576 Watertown         New York               4045.  
577 Waukesha          Wisconsin                54.5 
578 Wausau            Wisconsin               317.  
579 Waynesboro        Virginia               3059.  
580 West Allis        Wisconsin               250.  
581 West Jordan       Utah                    312.  
582 West Palm Beach   Florida                 141.  
583 Westfield         New Jersey              520.  
584 Westland          Michigan               2058.  
585 Westminster       California             3583.  
586 Wheeling          Illinois                737.  
587 Wheeling          West Virginia          1210.  
588 Whittier          California              445.  
589 Wichita           Kansas                  825.  
590 Wilmington        Delaware               6554.  
591 Wilmington        North Carolina          743.  
592 Wilson            North Carolina          369.  
593 Woodbury          Minnesota               608.  
594 Woodland          California              265.  
595 Woodstock         Illinois                857.  
596 Woonsocket        Rhode Island            196.  
597 Yonkers           New York               7658.  
598 York              Pennsylvania            818.  
599 Yucaipa           California               50.8 
600 Yuma              Arizona                 841.  
```

```
# A tibble: 1 x 2
  State        Sales
  <chr>        <dbl>
1 North Dakota  920.
```
Summary
```
Each state will have different sales, the state that sells the least is North Dakota  920.
```

### 3. Find the total number of customers listed. (Must be a unique customer)
ใช้ summarise ในการสรุปหาค่าจำนวนของลูกค้าทั้งหมด โดยใช้ n_distinct ในการหาจำนวนของลูกค้าทีไม่ซ้ำ
`n_distinct` -> "count the number of unique values" คือการเอาข้อมูลที่ Unique เท่านั้น 
```
superstore %>% summarise(AllCustomer = n_distinct(Customer.Name))
```

Result:

```
 AllCustomer
1         793
```
Summary:
```
There are 793 customers in the Superstore Sales Dataset.
```

### 4. What is the average sales volume each year?

mutate เพื่อสร้าง column แยกออกมาเป็น coloumn year และใช้ lubridate ในการ extract ค่า year ออกมาจาก date โดยมีการตรวจสอบ format ของ Date ว่าเป็นรูปแบบไหน 
คำสั่งที่ใช้ตรวจสอบคือ `year(), dmy()` จากนั้นจึงใช้คำสั่ง group_by โดยทำการ group_by ด้วยปีที่เรา extract ออกมา หลังจากนั้นจึง summarise เพื่อหาค่า mean จาก Sales
```
superstore  %>% mutate(year = year(dmy(Order.Date))) %>% group_by(year) %>% summarise(mean = mean(Sales))
```

Result:

```
# A tibble: 4 x 2
   year  mean
  <dbl> <dbl>
1  2015  246.
2  2016  224.
3  2017  237.
4  2018  222.
```
Summary:
```
- In 2015, the average sales amount was 246.
- In 2016, the average sales amount was 224.
- In 2017, the average sales amount was 237.
- In 2018, the average sales amount was 222.
```
### 5. Find the number of products in each sub-category
ใช้คำสั่ง `group_by()` จัดกลุ่มด้วย Sub-category และใช้คำสั่ง `summarise()` เพื่อสรุปผลจำนวนของสินค้าโดยตรวจสอบจากชื่อของสินค้าที่ไม่ซ้ำกัน ใช้คำสั่ง `n_distinct()`
```
superstore %>% group_by(Sub.Category) %>% summarise(TotalProduct = n_distinct(Product.Name))
```

Result:

```
# A tibble: 17 x 2
   Sub.Category TotalProduct
   <chr>               <int>
 1 Accessories           147
 2 Appliances             97
 3 Art                   157
 4 Binders               211
 5 Bookcases              50
 6 Chairs                 88
 7 Copiers                13
 8 Envelopes              44
 9 Fasteners              34
10 Furnishings           186
11 Labels                 70
12 Machines               63
13 Paper                 277
14 Phones                189
15 Storage               131
16 Supplies               36
17 Tables                 56
```

Summary:
This is a number of product in each sub-category.

Sub-category  | Total Product
------------- | -------------
Accessories  | 147
Appliances    |  97
Binders |  157
Appliances    |  211
Bookcases | 50
Chairs   | 88
Copiers    |  13
Envelopes   |  44
Fasteners   | 34
Furnishings  | 186
Labels  | 70
Machines | 63
Paper   | 277
Phones   | 189
Storage  | 131
Supplies    | 36
Tables | 56

### 6. How many customers are there in each region? And how much is the total sales in each region?
ใช้คำสั่ง `group_by()` จัดกลุ่มด้วย Region จากนั้นใช้คำสั่ง `summarise` เพื่อหาจำนวนของลูกค้าแต่ละภูมิภาค และยอดขายแต่ละภูมิภาค ด้วยจำนวนของ Customer ที่ ไม่ซ้ำ ใช้คำสั่ง `n_distinct()`และ คำสั่ง `sum()` เพื่อหาผลรวมของ Sales

```
superstore %>% group_by(Region) %>% summarise(NumOfCustomer = n_distinct(Customer.Name), SaleofRegion = sum(Sales))
```

Result:

```
  Region  NumOfCustomer SaleofRegion
  <chr>           <int>        <dbl>
1 Central           626      492647.
2 East              669      669519.
3 South             509      389151.
4 West              681      710220.
```
Summary:
```
In the central region, there are 626 total customers and sales of 492647.
In the east  region, there are 669 total customers and sales of 669519.
In the south  region, there are 509 total customers and sales of 389151.
In the west  region, there are 681 total customers and sales of 710220.
```
### 7. Find total sales in each segment.
ใช้คำสั่ง `group_by()` ในการจัดกลุ่ม Segment จากนั้น ใช้คำสั่ง `summarise()` เพื่อสรุปผลยอดขายทั้งหมด โดยใช้คำสั่ง `sum()` ด้วย Sales
```
superstore %>% group_by(Segment) %>% summarise(Total_sales = sum(Sales))
```
Result:
```
# A tibble: 3 x 2
  Segment     Total_sales
  <chr>             <dbl>
1 Consumer       1148061.
2 Corporate       688494.
3 Home Office     424982.
```
Summary:

Segment  | Total_sales
------------- | -------------
Consumer  | 1148061
Corporate     |  688494
Home Office |  424982

### 8. Which type of ship mode is the least used by people?
ใช้คำสั่ง `group_by()` ในการจัดกลุ่ม Ship.Mode จากนั้น ใช้คำสั่ง `summarise()` เพื่อสรุปหาจำนวนลูกค้าโดยใช้คำสั่ง ` n_distinct()` เพื่อเอาชื่อลูกค้าที่ไม่ซ้ำกัน  จากนั้น ใช้คำสั่ง `filter()` โดย filter จากจำนวนลูกค้าทั้งหมดในกลุ่มที่น้อยที่สุด
```
superstore %>% group_by(Ship.Mode) %>% summarise(Total_customers = n_distinct(Customer.Name)) %>% filter(Total_customers == min(Total_customers))
```
Result:
```
# A tibble: 1 x 2
  Ship.Mode Total_customers
  <chr>               <int>
1 Same Day              225
```
Summary:
```
The ship mode type with the least number of users is Same day.
```
## Part 4: Visualization with GGplot2
### 1.) The bar chart represents the number of product each sub-category.
```
product_sub <- superstore %>% group_by(Sub.Category) %>% summarise(TotalProduct = n_distinct(Product.Name))

##ggplot2
product_sub_plot <- product_sub %>% ggplot(aes(x = Sub.Category, y = TotalProduct)) + geom_bar(stat="identity", fill="steelblue") +
                    geom_text(aes(label=TotalProduct), vjust=1.6, color = "white", size = 3.5)

product_sub_plot + ggtitle("Number of Product each Sub-category") + xlab("Sub-Category") + ylab("Number of Product")

```
Result:

![Graph 1](https://github.com/sit-2021-int214/028_Anime_Recommentation/blob/master/assignment/HW04_63130500092/Rplot01.png)

จากการสร้างกราฟแท่งในการหาจำนวนสินค้าในแต่ละ sub-category จะสามารถทราบจำนวนของสินค้าในแต่ละ sub-category ได้ดังกราฟแท่ง และทำให้เราสามารถสังเกตข้อมูลเบื้องต้นได้ง่ายมากขึ้น เช่น จำนวนสินค้าที่ใน sub-category ที่มากที่สุด หรือ น้อยที่สุด

### 2.) The line chart represents the sales average each years.
```
product_year <- superstore  %>% mutate(year = year(dmy(Order.Date))) %>% group_by(year) %>% summarise(mean = mean(Sales))


##ggplot2
product_year_plot <- product_year %>% ggplot(aes(x = year, y = mean)) + geom_line(size = 1, linetype ="dashed", color = "blue") + geom_point(color = "red" , size = 2)
                                            
product_year_plot + ggtitle("Average sales for each year") + xlab("Years") + ylab("Sales average")
```
Result:

![Graph 2](https://github.com/sit-2021-int214/028_Anime_Recommentation/blob/master/assignment/HW04_63130500092/Rplot02.png)

จากการสร้างกราฟเส้นในการอธิบายราคาเฉลี่ยที่ขายได้ในแต่ละปี จะสังเกตได้ว่า ในช่วงปี 2015 จะมียอดขายเฉลี่ยมากที่สุดและลดลงมาในปี 2016 และเพิ่มขึ้นมาในปี 2017 ก่อนที่จะตกลงมาในช่วง 2018 ซึ่งเป็นปีที่ยอดขายเฉลี่ยน้อยที่สุด

